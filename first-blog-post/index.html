<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>SharePoint Thoughts  | Get Modern Team and Communication sites - SharePoint Online - CSOM</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.59.0" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.d98f2eb6bcd1eaedb7edf166bd16af26.css" rel="stylesheet">
    

    

    
      
    

    
    
    <meta property="og:title" content="Get Modern Team and Communication sites - SharePoint Online - CSOM" />
<meta property="og:description" content="Here is the quick sample code to extract all the site collections from SharePoint Online tenant, including the classic,modern team sites and communication sites.
This solution is based on Microsoft PnP . Follow the steps below
 Create a console application and then add the Nuget package &#8216;SharePointPnPCoreOnline&#8217;   Add the references  using Microsoft.Online.SharePoint.TenantAdministration;
using Microsoft.SharePoint.Client;
 Following lines of code will return all the sites including Modern Team and Communication sites." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ajeshkakkoprath.com/first-blog-post/" />
<meta property="article:published_time" content="2017-11-07T05:06:57+10:00" />
<meta property="article:modified_time" content="2017-11-07T05:06:57+10:00" />
<meta itemprop="name" content="Get Modern Team and Communication sites - SharePoint Online - CSOM">
<meta itemprop="description" content="Here is the quick sample code to extract all the site collections from SharePoint Online tenant, including the classic,modern team sites and communication sites.
This solution is based on Microsoft PnP . Follow the steps below
 Create a console application and then add the Nuget package &#8216;SharePointPnPCoreOnline&#8217;   Add the references  using Microsoft.Online.SharePoint.TenantAdministration;
using Microsoft.SharePoint.Client;
 Following lines of code will return all the sites including Modern Team and Communication sites.">


<meta itemprop="datePublished" content="2017-11-07T05:06:57&#43;10:00" />
<meta itemprop="dateModified" content="2017-11-07T05:06:57&#43;10:00" />
<meta itemprop="wordCount" content="143">



<meta itemprop="keywords" content="All Site Collections,CSOM,Modern Communication sites,Modern Team sites," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Get Modern Team and Communication sites - SharePoint Online - CSOM"/>
<meta name="twitter:description" content="Here is the quick sample code to extract all the site collections from SharePoint Online tenant, including the classic,modern team sites and communication sites.
This solution is based on Microsoft PnP . Follow the steps below
 Create a console application and then add the Nuget package &#8216;SharePointPnPCoreOnline&#8217;   Add the references  using Microsoft.Online.SharePoint.TenantAdministration;
using Microsoft.SharePoint.Client;
 Following lines of code will return all the sites including Modern Team and Communication sites."/>

  </head>

  <body class="ma0 avenir bg-near-white production ">

    
   
  

  <header>
    <div class="bg-black">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="https://ajeshkakkoprath.com/" class="f3 fw2 hover-white no-underline white-90 dib">
      SharePoint Thoughts
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/about/" title="About page">
              About
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/posts/" title="Posts page">
              Posts
            </a>
          </li>
          
        </ul>
      
      











    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">

    <header class="mt4 w-100">
      <p class="f6 b helvetica tracked">
          
        POSTS
      </p>
      <h1 class="f1 athelas mb1">Get Modern Team and Communication sites - SharePoint Online - CSOM</h1>
      
      <p class="tracked">
         By <strong>admin</strong>
      </p>
      
      
      <time class="f6 mv4 dib tracked" datetime="2017-11-07T05:06:57&#43;10:00">November 7, 2017</time>
      
      
    </header>

    <section class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr4-l w-two-thirds-l"><p>Here is the quick sample code to extract all the site collections from SharePoint Online tenant, including the classic,modern team sites and communication sites.</p>

<p>This solution is based on Microsoft PnP . Follow the steps below</p>

<ol>
<li>Create a console application and then add the Nuget package &#8216;SharePointPnPCoreOnline&#8217;</li>
</ol>

<p><img src="/uploads/2017/12/1.png?w=525" data-recalc-dims="1" /></p>

<ol>
<li>Add the references</li>
</ol>

<p><span style="color: #3366ff;">using</span> Microsoft.Online.SharePoint.TenantAdministration;<br />
<span style="color: #3366ff;">using</span> Microsoft.SharePoint.Client;</p>

<ol>
<li>Following lines of code will return all the sites including Modern Team and Communication sites.</li>
</ol>

<blockquote>
<p>using (ClientContext TenantContext = new ClientContext(&ldquo;<a href="https://xxxx-admin.sharepoint.com&quot;)">https://xxxx-admin.sharepoint.com&quot;)</a>)<br />
{<br />
var credentials = new SharePointOnlineCredentials(&ldquo;account@account.onmicrosoft.com&rdquo;;, GetPassword());<br />
TenantContext.Credentials = credentials;<br />
var tenant = new Tenant(TenantContext);<br />
var sitePropEnumerable = tenant.GetSiteCollections(startIndex: 0, endIndex: 300, includeDetail: true, includeOD4BSites: true);<br />
TenantContext.ExecuteQuery();<br />
//Load site url property for the time being<br />
var sitePropEnumerableLinq = sitePropEnumerable.Select(k =&gt; k.Url);<br />
foreach (string property in sitePropEnumerableLinq)<br />
{<br />
Console.WriteLine(property);<br />
}<br />
Console.ReadKey();<br />
}</p>

<p><span style="color: #333333; font-size: 1rem;">Parameter &#8216;includeOD4BSites&#8217; denotes the OneDrive for Business sites.</span></p>
</blockquote>

<p>OutPut</p>

<p><img src="/uploads/2017/12/2.png?w=525" data-recalc-dims="1" /></p>

<p>The complete code can be downloaded from <a href="/uploads/2017/12/program2.docx" title="Program">here.</a></p>
<ul class="pa0">
  
   <li class="list">
     <a href="/tags/all-site-collections" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">All Site Collections</a>
   </li>
  
   <li class="list">
     <a href="/tags/csom" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">CSOM</a>
   </li>
  
   <li class="list">
     <a href="/tags/modern-communication-sites" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Modern Communication sites</a>
   </li>
  
   <li class="list">
     <a href="/tags/modern-team-sites" class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">Modern Team sites</a>
   </li>
  
</ul>
<div class="mt6">
      
      <div id="commento"></div>
<script defer src="https://cdn.commento.io/js/commento.js"></script>

      </div>
    </section>

    <aside class="w-30-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-black bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://ajeshkakkoprath.com/" >
    &copy; 2019 SharePoint Thoughts
  </a>
    <div>










</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
